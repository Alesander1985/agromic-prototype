<!doctype html>
<html lang="ro">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AgroMic â€” prototip</title>

  <!-- MapLibre -->
  <link href="https://unpkg.com/maplibre-gl@4.7.1/dist/maplibre-gl.css" rel="stylesheet" />
  <script src="https://unpkg.com/maplibre-gl@4.7.1/dist/maplibre-gl.js"></script>

  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <header class="topbar">
    <div class="brand">
      <div class="logo">ğŸŒ±</div>
      <div>
        <div class="title">AgroMic</div>
        <div class="subtitle">Prototip (100% free, fÄƒrÄƒ backend)</div>
      </div>
    </div>

    <nav class="nav">
      <button class="navbtn" data-view="dashboard">Dashboard</button>
      <button class="navbtn" data-view="newFarm">AdaugÄƒ fermÄƒ</button>
      <button class="navbtn" data-view="chat">Agronom virtual</button>
      <button class="navbtn" data-view="settings">SetÄƒri</button>
    </nav>
  </header>

  <main class="container">
    <!-- DASHBOARD -->
    <section id="view-dashboard" class="view">
      <div class="row">
        <h1>Dashboard</h1>
        <div class="right">
          <button class="btn" id="btn-add-farm">+ AdaugÄƒ fermÄƒ</button>
        </div>
      </div>

      <div class="grid2">
        <div class="card">
          <h2>Fermele tale</h2>
          <div id="farm-list" class="list"></div>
          <div class="muted small">Datele sunt salvate local Ã®n browser (localStorage).</div>
        </div>

        <div class="card">
          <h2>NotiÈ›e rapide</h2>
          <textarea id="quick-notes" rows="8" placeholder="Scrie aici orice notiÈ›e..."></textarea>
          <div class="row">
            <button class="btn secondary" id="btn-save-notes">SalveazÄƒ</button>
            <button class="btn danger" id="btn-clear-all">È˜terge tot (reset)</button>
          </div>
          <div class="muted small">Reset È™terge fermele/culturile/chat-ul din acest browser.</div>
        </div>
      </div>
    </section>

    <!-- NEW FARM -->
    <section id="view-newFarm" class="view hidden">
      <div class="row">
        <h1>AdaugÄƒ fermÄƒ</h1>
        <div class="right">
          <button class="btn secondary" id="btn-cancel-farm">Ãnapoi</button>
        </div>
      </div>

      <div class="grid2">
        <div class="card">
          <h2>Detalii fermÄƒ</h2>

          <label>Nume fermÄƒ</label>
          <input id="farm-name" placeholder="Ex: Ferma Popescu" />

          <label>SuprafaÈ›Äƒ (ha)</label>
          <input id="farm-area" type="number" min="0" step="0.01" placeholder="Ex: 1.5" />

          <label>Localitate (sat/oraÈ™)</label>
          <div class="autocomplete">
            <input id="farm-locality" placeholder="Ãncepe sÄƒ scrii (min 3 caractere)..." autocomplete="off" />
            <div id="locality-suggestions" class="suggestions hidden"></div>
          </div>

          <div class="row smallgap">
            <div class="col">
              <label>Lat</label>
              <input id="farm-lat" placeholder="ex: 45.75" />
            </div>
            <div class="col">
              <label>Lon</label>
              <input id="farm-lon" placeholder="ex: 21.23" />
            </div>
          </div>

          <div class="muted small">
            SelecteazÄƒ o sugestie sau mutÄƒ pinul pe hartÄƒ. Coordonatele se actualizeazÄƒ automat.
          </div>

          <div class="row">
            <button class="btn" id="btn-save-farm">SalveazÄƒ ferma</button>
          </div>
        </div>

        <div class="card">
          <h2>HartÄƒ</h2>
          <div id="map" class="map"></div>
          <div class="muted small">HartÄƒ: MapLibre + OpenStreetMap tiles.</div>
        </div>
      </div>
    </section>

    <!-- FARM DETAILS -->
    <section id="view-farm" class="view hidden">
      <div class="row">
        <div>
          <h1 id="farm-title">FermÄƒ</h1>
          <div class="muted" id="farm-meta"></div>
        </div>
        <div class="right">
          <button class="btn secondary" id="btn-back-dashboard">Ãnapoi la dashboard</button>
        </div>
      </div>

      <div class="grid2">
        <div class="card">
          <h2>Meteo & prognozÄƒ (7 zile)</h2>
          <div id="weather-status" class="muted">Ãncarc...</div>
          <div id="weather-current" class="weather"></div>
          <div id="weather-forecast" class="forecast"></div>
        </div>

        <div class="card">
          <h2>AvertizÄƒri</h2>
          <div class="muted small">
            Pentru MVP: Ã®ncercÄƒm MeteoAlarm (RomÃ¢nia). DacÄƒ serverul blocheazÄƒ CORS pe GitHub Pages, afiÈ™Äƒm fallback.
          </div>
          <div id="alerts-box" class="alerts"></div>
        </div>
      </div>

      <div class="grid2">
        <div class="card">
          <div class="row">
            <h2>Culturile fermei</h2>
            <div class="right">
              <button class="btn" id="btn-add-crop">+ AdaugÄƒ culturÄƒ</button>
            </div>
          </div>

          <div id="crop-list" class="list"></div>
        </div>

        <div class="card">
          <h2>RecomandÄƒri pentru sÄƒptÄƒmÃ¢na aceasta</h2>
          <div id="reco-box" class="reco"></div>
          <div class="muted small">
            RecomandÄƒri generale (prototip). Pentru substanÈ›e/doze, consultÄƒ un specialist È™i respectÄƒ eticheta produsului.
          </div>
        </div>
      </div>

      <!-- Add crop modal -->
      <div id="modal" class="modal hidden">
        <div class="modal-content">
          <div class="row">
            <h3>AdaugÄƒ culturÄƒ</h3>
            <div class="right"><button class="btn secondary" id="btn-close-modal">Ãnchide</button></div>
          </div>

          <label>CulturÄƒ (din listÄƒ)</label>
          <select id="crop-select"></select>

          <label>SuprafaÈ›Äƒ alocatÄƒ (ha) (opÈ›ional)</label>
          <input id="crop-area" type="number" min="0" step="0.01" placeholder="Ex: 0.2" />

          <label>Data estimatÄƒ plantare (opÈ›ional)</label>
          <input id="crop-date" type="date" />

          <label>NotiÈ›e (opÈ›ional)</label>
          <textarea id="crop-notes" rows="3" placeholder="Ex: solar, irigare prin picurare..."></textarea>

          <div class="row">
            <button class="btn" id="btn-save-crop">SalveazÄƒ cultura</button>
          </div>
        </div>
      </div>
    </section>

    <!-- CHAT -->
    <section id="view-chat" class="view hidden">
      <div class="row">
        <h1>Agronom virtual</h1>
        <div class="right">
          <select id="chat-farm-select"></select>
        </div>
      </div>

      <div class="card">
        <div class="muted small">
          Chat simulat pentru prototip. Ãn etapa 2 Ã®l legÄƒm la AI real (API).
        </div>

        <div id="chat-log" class="chatlog"></div>

        <div class="chatbox">
          <input id="chat-input" placeholder="ÃntreabÄƒ: â€Ce lucrÄƒri recomand pentru roÈ™ii sÄƒptÄƒmÃ¢na asta?â€" />
          <button class="btn" id="chat-send">Trimite</button>
        </div>
      </div>
    </section>

    <!-- SETTINGS -->
    <section id="view-settings" class="view hidden">
      <div class="row">
        <h1>SetÄƒri</h1>
      </div>

      <div class="card">
        <h2>Despre prototip</h2>
        <ul class="bullets">
          <li>Nu are conturi reale; datele stau doar Ã®n browserul tÄƒu (localStorage).</li>
          <li>Meteo: Open-Meteo (fÄƒrÄƒ cheie).</li>
          <li>HartÄƒ: MapLibre + OSM tiles (fÄƒrÄƒ cheie).</li>
          <li>Autocomplete: Nominatim (OSM) cu debounce.</li>
          <li>Alerte: MeteoAlarm (poate fi blocat de CORS pe GitHub Pages; avem fallback).</li>
        </ul>
      </div>
    </section>
  </main>

  <footer class="footer">
    <div class="muted small">AgroMic â€” prototip. Â©</div>
  </footer>

  <script src="app.js"></script>
</body>
</html>
